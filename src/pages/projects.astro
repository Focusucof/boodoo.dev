---
import Breadcrumbs from "@/components/Breadcrumbs.astro";
import PageHead from '@/components/PageHead.astro'
import ProjectCard from '@/components/ProjectCard.astro'
import Layout from '@/layouts/Layout.astro'
import { getAllProjects, groupProjectsByYear } from '@/lib/data-utils'

const projects = await getAllProjects()
const projectsByYear = groupProjectsByYear(projects)
const years = Object.keys(projectsByYear).sort(
  (a, b) => parseInt(b) - parseInt(a),
)

---
<Layout class="max-w-3xl">
  <PageHead slot="head" title="Projects" />
  <div class="mx-auto w-full max-w-[calc(var(--container-3xl)-2rem)] mt-12">
    <Breadcrumbs items={[{ label: 'Projects', icon: 'lucide:briefcase' }]} />
  </div>

  <section
    class="mx-auto flex max-w-[calc(var(--container-3xl)-2rem)] flex-col gap-4"
  >
    
    <div class="flex flex-col gap-y-8">
      {
        years.map((year) => (
          <section class="mb-16 relative">
            <div class="md:absolute md:-left-24 md:top-0 mb-8 md:mb-0">
                <h2 class="text-4xl font-bold text-muted-foreground/20 select-none">{year}</h2>
            </div>

            <ul class="flex flex-col gap-4">
              {projectsByYear[year].map((project) => (
                <li>
                  <ProjectCard project={project} />
                </li>
              ))}
            </ul>
          </section>
        ))
      }
    </div>
  </section>
</Layout>